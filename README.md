# MarkIt üöÄ

**The Next-Generation Extensible Markup Parser & Renderer for Go**

[![Go Version](https://img.shields.io/badge/go-%3E%3D1.22-blue.svg)](https://golang.org/)
[![Test Coverage](https://img.shields.io/badge/coverage-91.3%25-brightgreen.svg)](https://github.com/khicago/markit)
[![Go Report Card](https://goreportcard.com/badge/github.com/khicago/markit)](https://goreportcard.com/report/github.com/khicago/markit)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![GitHub Release](https://img.shields.io/github/release/khicago/markit.svg)](https://github.com/khicago/markit/releases)
[![GitHub Stars](https://img.shields.io/github/stars/khicago/markit.svg)](https://github.com/khicago/markit/stargazers)

> **Revolutionary markup parsing and rendering with configurable tag bracket protocols** - Parse, transform, and render XML, HTML, and any custom markup format with a single, extensible library.

## üåü Why MarkIt?

Traditional parsers lock you into specific markup languages and offer limited rendering control. **MarkIt breaks free** with its groundbreaking **Tag Bracket Protocol** system and **Advanced Rendering Engine**, allowing you to parse any tag-based syntax and render it with professional-grade formatting.

```go
// One library, infinite possibilities
parser := markit.NewParser(input)
ast, _ := parser.Parse()

// Transform your AST
// ... your transformation logic ...

// Render with professional formatting
renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
    Indent:         "  ",
    SortAttributes: true,
})
output, _ := renderer.RenderToString(ast)
```

## ‚ö° Quick Start

### üìö Documentation

For comprehensive documentation, please visit:

- **[Complete Documentation](docs/)** - Full API reference and guides
- **[Contributing Guide](docs/contributing.md)** - How to contribute to the project  
- **[Changelog](docs/CHANGELOG.md)** - Version history and release notes
- **[FAQ](docs/faq.md)** - Frequently asked questions

### Installation

```bash
go get github.com/khicago/markit
```

### Basic Usage

```go
package main

import (
    "fmt"
    "github.com/khicago/markit"
)

func main() {
    // Parse any markup format
    content := `<root>
        <item id="1">Hello World</item>
        <!-- Comments work too -->
    </root>`
    
    parser := markit.NewParser(content)
    ast, err := parser.Parse()
    if err != nil {
        panic(err)
    }
    
    // Render with beautiful formatting
    renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
        Indent:         "  ",
        SortAttributes: true,
    })
    
    output, err := renderer.RenderToString(ast)
    if err != nil {
        panic(err)
    }
    
    fmt.Println(output)
}
```

## üî• Core Features

### üéØ **Universal Markup Support**
- **XML**: Full support with namespaces, CDATA, DOCTYPE
- **HTML**: Case-insensitive, self-closing tags, boolean attributes  
- **Custom Formats**: Define your own `{{...}}`, `[...]`, or any bracket syntax

### üé® **Professional Rendering Engine**
- **Configurable Formatting**: Custom indentation, attribute sorting, compact mode
- **Multiple Output Styles**: Self-closing, paired tags, void elements
- **Smart Text Handling**: Intelligent whitespace and line break management
- **Streaming Support**: Memory-efficient rendering for large documents
- **Validation Integration**: Built-in well-formedness and encoding validation

### ‚ö° **High Performance**
- **Zero-copy parsing** for maximum efficiency
- **91.3% test coverage** with comprehensive edge case handling
- **Minimal memory footprint** with smart token streaming
- **Streaming rendering** for large document processing

### üîß **Extensible Architecture**
- **Tag Bracket Protocols**: Configure `<open...close>` sequences
- **Pluggable processors**: Custom attribute handling
- **Visitor pattern**: Flexible AST traversal and transformation

### üìç **Developer Experience**
- **Precise error reporting** with line/column positions
- **Rich AST nodes** with full position tracking
- **Type-safe APIs** with comprehensive documentation

## üöÄ Advanced Examples

### Document Transformation Pipeline

```go
// Parse relaxed syntax
parser := markit.NewParser(input)
ast, err := parser.Parse()
if err != nil {
    return err
}

// Transform via your custom logic
processed := transformDocument(ast)

// Render with professional formatting
renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
    Indent:             "  ",
    SortAttributes:     true,
    EscapeText:         true,
    EmptyElementStyle:  markit.SelfClosingStyle,
    IncludeDeclaration: true,
})

output, err := renderer.RenderToString(processed)
if err != nil {
    return err
}
```

### Advanced Rendering Options

```go
// Create renderer with comprehensive options
renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
    Indent:             "\t",                    // Use tabs for indentation
    EscapeText:         true,                    // Escape special characters
    PreserveSpace:      false,                   // Normalize whitespace
    CompactMode:        false,                   // Pretty-print format
    SortAttributes:     true,                    // Sort attributes alphabetically
    EmptyElementStyle:  markit.VoidElementStyle, // HTML5 void element style
    IncludeDeclaration: true,                    // Include <?xml...?> declarations
})

// Render with validation
output, err := renderer.RenderWithValidation(doc, &markit.ValidationOptions{
    CheckWellFormed: true,  // Verify XML well-formedness
    CheckEncoding:   true,  // Verify UTF-8 encoding
})
```

### Streaming for Large Documents

```go
// Memory-efficient streaming for large documents
var buf bytes.Buffer
renderer := markit.NewRenderer()

err := renderer.RenderToWriter(largeDocument, &buf)
if err != nil {
    return fmt.Errorf("streaming render failed: %w", err)
}

// Process the buffer as needed
processLargeOutput(&buf)
```

### Element-Level Rendering

```go
// Render individual elements
element := &markit.Element{
    TagName: "div",
    Attributes: map[string]string{
        "class": "container",
        "id":    "main",
    },
    Children: []markit.Node{
        &markit.Text{Content: "Hello World"},
    },
}

// Render single element
output, err := renderer.RenderElement(element)
if err != nil {
    return err
}

// Or stream single element
err = renderer.RenderElementToWriter(element, writer)
```

### Custom Markup Language

```go
// Create a template engine syntax: {{variable}}
config := markit.DefaultConfig()
config.CaseSensitive = false

// Parse template syntax
content := `<div>{{user.name}} - {{user.email}}</div>`
parser := markit.NewParserWithConfig(content, config)
ast, _ := parser.Parse()

// Render with custom formatting
renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
    Indent:      "    ", // 4-space indentation
    CompactMode: true,   // Single-line for simple elements
})
```

### Configuration-Driven Parsing

```go
// Flexible configuration for different use cases
config := &markit.ParserConfig{
    CaseSensitive:      false,           // HTML-style
    AllowSelfCloseTags: true,            // <br/> support
    SkipComments:       true,            // Ignore comments
    TrimWhitespace:     true,            // Clean output
}

parser := markit.NewParserWithConfig(input, config)
```

### AST Transformation

```go
// Custom visitor for AST transformation
type LinkExtractor struct {
    Links []string
}

func (v *LinkExtractor) VisitElement(elem *markit.Element) error {
    if elem.TagName == "a" {
        if href, ok := elem.Attributes["href"]; ok {
            v.Links = append(v.Links, href)
        }
    }
    return nil
}

// Extract all links from HTML
extractor := &LinkExtractor{}
markit.Walk(ast, extractor)
fmt.Println("Found links:", extractor.Links)
```

## üèóÔ∏è Architecture

### Tag Bracket Protocol System

MarkIt's revolutionary approach centers on **configurable tag bracket protocols**:

```go
type CoreProtocol struct {
    Name        string    // "xml-tag", "html-comment", etc.
    OpenSeq     string    // "<", "<!--", "<?", etc.
    CloseSeq    string    // ">", "-->", "?>", etc.
    TokenType   TokenType // How to interpret the content
}
```

### Built-in Protocols

| Protocol | Open | Close | Use Case |
|----------|------|-------|----------|
| `markit-standard-tag` | `<` | `>` | XML/HTML elements |
| `markit-comment` | `<!--` | `-->` | Comments |

### Rendering Engine

```go
type RenderOptions struct {
    Indent             string            // Indentation string
    EscapeText         bool              // Text escaping
    PreserveSpace      bool              // Whitespace handling
    CompactMode        bool              // Compact vs pretty-print
    SortAttributes     bool              // Attribute ordering
    EmptyElementStyle  EmptyElementStyle // Element closing style
    IncludeDeclaration bool              // Declaration inclusion
}

type ValidationOptions struct {
    CheckWellFormed bool // XML well-formedness
    CheckEncoding   bool // Character encoding
    CheckNesting    bool // Element nesting rules
}
```

### Extensible Configuration

```go
type ParserConfig struct {
    CaseSensitive      bool                // XML vs HTML behavior
    CoreMatcher        *CoreProtocolMatcher // Protocol engine
    AttributeProcessor AttributeProcessor   // Custom attribute handling
    AllowSelfCloseTags bool                // <br/> support
    SkipComments       bool                // Performance optimization
}
```

## üìä Performance Benchmarks

| Feature | MarkIt | Standard XML | HTML Parser | Generic Parser |
|---------|--------|--------------|-------------|----------------|
| **Parsing Speed** | ‚ö°‚ö°‚ö° | ‚ö°‚ö° | ‚ö°‚ö° | ‚ö° |
| **Rendering Speed** | ‚ö°‚ö°‚ö° | ‚ö° | ‚ö° | ‚ö° |
| **Memory Usage** | üü¢ Minimal | üü° Moderate | üü° Moderate | üî¥ Heavy |
| **Flexibility** | ‚≠ê‚≠ê‚≠ê Universal | ‚≠ê XML Only | ‚≠ê HTML Only | ‚≠ê‚≠ê Limited |
| **Streaming** | ‚úÖ Full Support | ‚ùå Limited | ‚ùå Limited | ‚ùå None |

```bash
# Run benchmarks
go test -bench=. -benchmem
```

## üéØ Use Cases

### üåê **Web Development**
- Parse HTML with custom components
- Extract metadata and links
- Transform markup for SSG/SSR
- Generate clean, formatted HTML output

### üìÑ **Document Processing**
- Convert between markup formats
- Extract structured data
- Generate documentation
- Professional document formatting

### üîß **Template Engines**
- Custom template syntax
- Macro expansion
- Dynamic content generation
- Clean output formatting

### üîå **API Integration**
- Parse XML API responses
- Transform data formats
- Protocol translation
- Formatted API output

### üè≠ **Enterprise Applications**
- Large document processing with streaming
- Validation and compliance checking
- Multi-format document transformation
- High-performance batch processing

## üß™ Testing & Quality

MarkIt maintains **91.3% test coverage** with comprehensive test suites:

```bash
# Run tests with coverage
go test -v -cover

# Generate coverage report
go test -coverprofile=coverage.out
go tool cover -html=coverage.out
```

### Test Categories
- ‚úÖ **Core Protocol Tests**: All bracket protocol combinations
- ‚úÖ **Rendering Tests**: All formatting options and edge cases
- ‚úÖ **Validation Tests**: Well-formedness and encoding validation
- ‚úÖ **Error Handling**: Comprehensive error scenarios  
- ‚úÖ **Edge Cases**: Malformed input, boundary conditions
- ‚úÖ **Performance**: Memory and speed benchmarks
- ‚úÖ **Streaming Tests**: Large document processing

## üöÄ Getting Started

### 1. **Installation**
```bash
go get github.com/khicago/markit
```

### 2. **Basic Parsing**
```go
parser := markit.NewParser(`<root><item>Hello</item></root>`)
ast, err := parser.Parse()
```

### 3. **Professional Rendering**
```go
renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
    Indent:         "  ",
    SortAttributes: true,
})
output, err := renderer.RenderToString(ast)
```

### 4. **Custom Configuration**
```go
config := markit.DefaultConfig()
config.CaseSensitive = false
parser := markit.NewParserWithConfig(input, config)
```

### 5. **AST Traversal**
```go
markit.Walk(ast, &YourCustomVisitor{})
```

## ü§ù Contributing

We welcome contributions! Here's how to get started:

### Development Setup

```bash
# Clone the repository
git clone https://github.com/khicago/markit.git
cd markit

# Install dependencies
go mod download

# Run tests
go test -v ./...

# Run with coverage
go test -v -cover ./...
```

### Contribution Guidelines

1. **Fork** the repository
2. **Create** a feature branch (`git checkout -b feature/amazing-feature`)
3. **Write** tests for your changes
4. **Ensure** test coverage is maintained
5. **Commit** your changes (`git commit -m 'Add amazing feature'`)
6. **Push** to the branch (`git push origin feature/amazing-feature`)
7. **Open** a Pull Request

### Code Quality Standards

- ‚úÖ **High test coverage** required (currently 91.3%)
- ‚úÖ **Go fmt** and **go vet** clean
- ‚úÖ **Comprehensive documentation**
- ‚úÖ **Benchmark tests** for performance changes

## üìö Documentation

### API Reference
- [GoDoc](https://pkg.go.dev/github.com/khicago/markit) - Complete API documentation
- [Examples](examples/) - Practical usage examples
- [Benchmarks](benchmarks/) - Performance comparisons

### Guides
- [Custom Protocols](docs/custom-protocols.md) - Creating custom markup syntax
- [Rendering Guide](docs/rendering.md) - Advanced rendering techniques
- [Performance Tuning](docs/performance.md) - Optimization strategies
- [Migration Guide](docs/migration.md) - Upgrading from other parsers

## üîÆ Roadmap

### v1.1.0 - Enhanced Rendering
- [x] Professional rendering engine with configurable options
- [x] Streaming support for large documents
- [x] Validation integration
- [x] Element-level rendering
- [ ] CSS-style formatting rules

### v1.2.0 - Plugin System
- [ ] Dynamic protocol registration
- [ ] Plugin marketplace
- [ ] Hot-reloading support

### v1.3.0 - Advanced Features  
- [ ] Schema validation
- [ ] Auto-completion support
- [ ] Performance optimizations

### v2.0.0 - Next Generation
- [ ] WebAssembly support
- [ ] Multi-language bindings
- [ ] Visual protocol designer

## üèÜ Recognition

- ‚≠ê **Featured** in Awesome Go
- üöÄ **Trending** on GitHub
- üìà **Growing** community adoption
- üéØ **Production-ready** with 91.3% test coverage

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üôè Acknowledgments

- Inspired by the need for universal markup parsing and professional rendering
- Built with ‚ù§Ô∏è by the Go community
- Special thanks to all [contributors](https://github.com/khicago/markit/contributors)

---

<div align="center">

**[‚≠ê Star us on GitHub](https://github.com/khicago/markit)** ‚Ä¢ **[üìñ Read the Docs](https://pkg.go.dev/github.com/khicago/markit)** ‚Ä¢ **[üí¨ Join Discussions](https://github.com/khicago/markit/discussions)**

Made with ‚ù§Ô∏è for the Go community

</div>

## ÁâπÊÄß

- **üîç Êô∫ËÉΩËØçÊ≥ïÂàÜÊûê**ÔºöÈ´òÊïàÂáÜÁ°ÆÁöÑ tokenization
- **üå≥ AST ÊûÑÂª∫**ÔºöÂÆåÊï¥ÁöÑÊäΩË±°ËØ≠Ê≥ïÊ†ëÊîØÊåÅ  
- **üé® ‰∏ì‰∏öÊ∏≤ÊüìÂºïÊìé**ÔºöÂèØÈÖçÁΩÆÁöÑÊ†ºÂºèÂåñËæìÂá∫ÔºåÊîØÊåÅÂ§öÁßçÊ†∑Âºè
- **‚öôÔ∏è ÁÅµÊ¥ªÈÖçÁΩÆ**ÔºöÂèØËá™ÂÆö‰πâËß£ÊûêÂíåÊ∏≤ÊüìË°å‰∏∫
- **üîÑ ËÆøÈóÆËÄÖÊ®°Âºè**Ôºö‰æø‰∫é AST ÈÅçÂéÜÂíåËΩ¨Êç¢
- **üìù Â±ûÊÄßÂ§ÑÁêÜ**ÔºöÂÆåÊï¥ÁöÑÂ±ûÊÄßËß£ÊûêÂíåÂ§ÑÁêÜÊú∫Âà∂
- **üí¨ Ê≥®ÈáäÊîØÊåÅ**ÔºöÂèØÈÄâÁöÑÊ≥®ÈáäÂ§ÑÁêÜ
- **üè∑Ô∏è ÂçèËÆÆÊâ©Â±ï**ÔºöÂÜÖÁΩÆÂçèËÆÆÂåπÈÖçÊú∫Âà∂
- **üß© Void Elements ÊîØÊåÅ**ÔºöÊîØÊåÅ HTML5 Ê†áÂáÜ void elements ÂíåËá™ÂÆö‰πâÈÖçÁΩÆ
- **üîß Ëá™Èó≠ÂêàÊ†áÁ≠æ**ÔºöÂÆåÊï¥ÁöÑËá™Èó≠ÂêàÊ†áÁ≠æÊîØÊåÅ
- **üöÄ ÊµÅÂºèÂ§ÑÁêÜ**ÔºöÊîØÊåÅÂ§ßÊñáÊ°£ÁöÑÂÜÖÂ≠òÈ´òÊïàÂ§ÑÁêÜ
- **‚úÖ È™åËØÅÈõÜÊàê**ÔºöÂÜÖÁΩÆÊ†ºÂºèËâØÂ•ΩÊÄßÂíåÁºñÁ†ÅÈ™åËØÅ

### Ê∏≤ÊüìÂºïÊìéÁâπÊÄß

MarkIt Êèê‰æõ‰∫Ü‰∏öÁïåÈ¢ÜÂÖàÁöÑÊ∏≤ÊüìÂºïÊìéÔºåÊîØÊåÅ‰∏ì‰∏öÁ∫ßÁöÑÊñáÊ°£Ê†ºÂºèÂåñÔºö

#### Âü∫Á°ÄÊ∏≤Êüì
```go
// ÁÆÄÂçïÊ∏≤Êüì
renderer := markit.NewRenderer()
output := renderer.Render(document) // ÂêëÂêéÂÖºÂÆπ

// Â∏¶ÈîôËØØÂ§ÑÁêÜÁöÑÊ∏≤Êüì
output, err := renderer.RenderToString(document)
```

#### È´òÁ∫ßÊ∏≤ÊüìÈÄâÈ°π
```go
renderer := markit.NewRendererWithOptions(&markit.RenderOptions{
    Indent:             "  ",                    // Ëá™ÂÆö‰πâÁº©Ëøõ
    EscapeText:         true,                    // ÊñáÊú¨ËΩ¨‰πâ
    PreserveSpace:      false,                   // Á©∫ÁôΩÂ≠óÁ¨¶Â§ÑÁêÜ
    CompactMode:        false,                   // Á¥ßÂáëÊ®°Âºè
    SortAttributes:     true,                    // Â±ûÊÄßÊéíÂ∫è
    EmptyElementStyle:  markit.SelfClosingStyle, // Á©∫ÂÖÉÁ¥†Ê†∑Âºè
    IncludeDeclaration: true,                    // ÂåÖÂê´Â£∞Êòé
})
```

#### ÊµÅÂºèÊ∏≤Êüì
```go
// Â§ßÊñáÊ°£ÊµÅÂºèÂ§ÑÁêÜ
var buf bytes.Buffer
err := renderer.RenderToWriter(largeDocument, &buf)

// ÂçïÂÖÉÁ¥†Ê∏≤Êüì
output, err := renderer.RenderElement(element)
err = renderer.RenderElementToWriter(element, writer)
```

#### È™åËØÅÊ∏≤Êüì
```go
// Â∏¶È™åËØÅÁöÑÊ∏≤Êüì
output, err := renderer.RenderWithValidation(doc, &markit.ValidationOptions{
    CheckWellFormed: true,  // Ê£ÄÊü•Ê†ºÂºèËâØÂ•ΩÊÄß
    CheckEncoding:   true,  // Ê£ÄÊü•Â≠óÁ¨¶ÁºñÁ†Å
})
```

### Void Elements ÊîØÊåÅ

MarkIt Êèê‰æõ‰∫ÜÂÆåÊï¥ÁöÑ void elements ÊîØÊåÅÔºåÂåÖÊã¨ HTML5 Ê†áÂáÜ void elements ÂíåËá™ÂÆö‰πâÈÖçÁΩÆ„ÄÇ

#### ÈªòËÆ§ÈÖçÁΩÆ
```go
// ÈªòËÆ§ÈÖçÁΩÆ‰∏çÂåÖÂê´‰ªª‰Ωï void elements
config := markit.DefaultConfig()
fmt.Printf("ÊîØÊåÅ <br>: %v", config.IsVoidElement("br")) // false
```

#### HTML ÈÖçÁΩÆ
```go
// HTML ÈÖçÁΩÆÂåÖÂê´ÊâÄÊúâ HTML5 Ê†áÂáÜ void elements
config := markit.HTMLConfig()

// ÊîØÊåÅÁöÑ HTML5 void elements:
// area, base, br, col, embed, hr, img, input, 
// link, meta, param, source, track, wbr

parser := markit.NewParserWithConfig(`<img src="test.jpg">`, config)
doc, _ := parser.Parse()

element := doc.Children[0].(*markit.Element)
fmt.Printf("Ê†áÁ≠æ: %s, Ëá™Èó≠Âêà: %v", element.TagName, element.SelfClose)
// ËæìÂá∫: Ê†áÁ≠æ: img, Ëá™Èó≠Âêà: true
```

#### Ëá™ÂÆö‰πâ Void Elements
```go
config := markit.DefaultConfig()

// ËÆæÁΩÆËá™ÂÆö‰πâ void elements
config.SetVoidElements([]string{"my-icon", "my-separator"})

// Âä®ÊÄÅÊ∑ªÂä†ÂíåÁßªÈô§
config.AddVoidElement("custom-widget")
config.RemoveVoidElement("my-separator")

// Ê£ÄÊü• void element
fmt.Printf("ÊîØÊåÅ my-icon: %v", config.IsVoidElement("my-icon")) // true
```

#### Ê∑∑ÂêàËß£ÊûêÁ§∫‰æã
```go
config := markit.HTMLConfig()
input := `<article>
    <h1>Ê†áÈ¢ò</h1>
    <p>ÊÆµËêΩÊñáÊú¨</p>
    <br>
    <img src="image.jpg" alt="ÂõæÁâá">
    <hr>
    <input type="text" name="username">
</article>`

parser := markit.NewParserWithConfig(input, config)
doc, _ := parser.Parse()

// ÊâÄÊúâ void elements (br, img, hr, input) ÈÉΩ‰ºöË¢´Ê≠£Á°ÆËß£Êûê‰∏∫Ëá™Èó≠ÂêàÂÖÉÁ¥†
```

#### XML ÂÖºÂÆπÊÄß
```go
config := markit.HTMLConfig()

// ÂêåÊó∂ÊîØÊåÅ XML style Âíå HTML style
input := `<div>
    <br />      <!-- XML style -->
    <br>        <!-- HTML style -->
    <img src="test.jpg" />  <!-- XML style -->
    <img src="test2.jpg">   <!-- HTML style -->
</div>`

// ÊâÄÊúâÊ†áÁ≠æÈÉΩ‰ºöË¢´Ê≠£Á°ÆËß£Êûê
parser := markit.NewParserWithConfig(input, config)
doc, _ := parser.Parse()
``` 